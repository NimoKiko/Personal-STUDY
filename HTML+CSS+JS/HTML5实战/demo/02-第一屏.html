<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <!-- 分辨率范围：1200 ~ 2000 -->
    <link rel="stylesheet" href="./css/css.css" />
  </head>
  <body>
    <section id="wrap">
      <!-- 流体布局 -->
      <header id="head">
        <!-- 固定布局 -->
        <div class="headMain">
          <h1 class="logo">
            <a href="javascript:;">
              <img class="logoImg" src="./img/logo.png" alt="" />
            </a>
          </h1>
          <nav class="nav">
            <ul class="list">
              <li>
                <a href="javascript:;">
                  <div class="up">
                    <img
                      style="width: 20px; height: 20px"
                      src="./img/home_black.png"
                      alt=""
                    />
                  </div>
                  <div class="down">
                    <img
                      style="width: 20px; height: 20px"
                      src="./img/home_blue.png"
                      alt=""
                    />
                  </div>
                </a>
              </li>
              <li>
                <a href="javascript:;">
                  <div class="up">Course</div>
                  <div class="down">Course</div>
                </a>
              </li>
              <li>
                <a href="javascript:;">
                  <div class="up">Works</div>
                  <div class="down">Works</div>
                </a>
              </li>
              <li>
                <a href="javascript:;">
                  <div class="up">About</div>
                  <div class="down">About</div>
                </a>
              </li>
              <li>
                <a href="javascript:;">
                  <div class="up">Team</div>
                  <div class="down">Team</div>
                </a>
              </li>
            </ul>
          </nav>
          <div class="arrow">
            <img src="./img//jiantou.png" alt="" />
          </div>
        </div>
      </header>
      <section id="content">
        <ul class="list">
          <!-- 第一屏 -->
          <li class="home">
            <section style="background:transparent;">
              <ul class="home1">
                <li class="active">
                  <div class="item commonTitle">one layer</div>
                </li>
                <li>
                  <div class="item commonTitle">two layer</div>
                </li>
                <li>
                  <div class="item commonTitle">three layer</div>
                </li>
                <li>
                  <div class="item commonTitle">four layer</div>
                </li>
              </ul>
              <ul class="home2">
                <li class="active"></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </section>
          </li>
          <!-- 第二屏 -->
          <li class="Course">
            <section>
              <header class="course1 commonTitle">
                <span>阴阳师</span> <br />
                <span>六周年庆</span> <br />
                <span>星守千年</span> <br />
              </header>
              <div class="course2 commonText">
                <p>
                  以世间的花,蛇为灵感,以青色为主，更能够突出清姬的淡雅与幽静。蛇的受伤如同清姬心中的伤痕。
                </p>
                <p style="margin-top: 20px">
                  这世间的百花,总能让清姬回顾之前与他共度的美好时光。还有那如影随形的头骨，仿佛他从未离开过一般。如果有人想抢夺她手中的头骨，她会毫不留情的让他从这世上消失，挫骨扬灰。
                </p>
              </div>
              <div class="course3">
                <div class="item">
                  <div class="face"></div>
                  <div class="backFace">缚骨清姬</div>
                </div>
                <div class="item">
                  <div class="face"></div>
                  <div class="backFace">缚骨清姬</div>
                </div>
                <div class="item">
                  <div class="face"></div>
                  <div class="backFace">缚骨清姬</div>
                </div>
                <div class="item">
                  <div class="face"></div>
                  <div class="backFace">缚骨清姬</div>
                </div>
                <div class="item">
                  <div class="face"></div>
                  <div class="backFace">缚骨清姬</div>
                </div>
                <div class="item">
                  <div class="face"></div>
                  <div class="backFace">缚骨清姬</div>
                </div>
                <div class="item">
                  <div class="face"></div>
                  <div class="backFace">缚骨清姬</div>
                </div>
                <div class="item">
                  <div class="face"></div>
                  <div class="backFace">缚骨清姬</div>
                </div>
                <div class="item">
                  <div class="face"></div>
                  <div class="backFace">缚骨清姬</div>
                </div>
                <div class="item">
                  <div class="face"></div>
                  <div class="backFace">缚骨清姬</div>
                </div>
                <div class="item">
                  <div class="face"></div>
                  <div class="backFace">缚骨清姬</div>
                </div>
                <div class="item">
                  <div class="face"></div>
                  <div class="backFace">缚骨清姬</div>
                </div>
              </div>
            </section>
          </li>
          <!-- 第三屏 -->
          <li class="Works">
            <section>
              <header class="works1 commonTitle">
                <span>阴阳师</span> <br />
                <span>六周年庆</span> <br />
                <span>星守千年</span> <br />
              </header>
              <div class="list">
                <div class="item">
                  <img src="./img/page3_01.png" alt="" />
                  <div class="mask">
                    <span>测试文字</span>
                    <div class="icon"></div>
                  </div>
                </div>
                <div class="item">
                  <img src="./img/page3_02.png" alt="" />
                  <div class="mask">
                    <span>测试文字</span>
                    <div class="icon"></div>
                  </div>
                </div>
                <div class="item">
                  <img src="./img/page3_03.png" alt="" />
                  <div class="mask">
                    <span>测试文字</span>
                    <div class="icon"></div>
                  </div>
                </div>
                <div class="item">
                  <img style="width: 360px" src="./img/page3_04.png" alt="" />
                  <div class="mask">
                    <span>测试文字</span>
                    <div class="icon"></div>
                  </div>
                </div>
              </div>
              <div class="robot"><img src="./img/qingji.png" alt="" /></div>
            </section>
          </li>
          <li class="About">
            <section>About</section>
          </li>
          <li class="Team">
            <section>Team</section>
          </li>
        </ul>
      </section>
    </section>
  </body>
  <script>
    window.onload = function () {
      // 获取dom元素
      // 获取箭头的dom
      var arrow = document.querySelector("#head .headMain > .arrow");
      // 获取li的dom
      var liNodes = document.querySelectorAll(
        "#head .headMain > .nav > .list > li"
      );
      // 获取移到li上时的样式的dom
      var upNodes = document.querySelectorAll(
        "#head .headMain > .nav > .list > li .up"
      );
      // 获取第一个li节点
      var firstLiNode = liNodes[0];
      // 获取第一个up节点
      var firstUpNode = firstLiNode.querySelector(".up");
      // 获取头部节点
      var head = document.querySelector("#head");
      // 获取内容区节点
      var content = document.querySelector("#content");
      // 获取每一屏的内容区节点
      var cLiNodes = document.querySelectorAll("#content > .list > li");
      // 获取每一屏的节点
      var cList = document.querySelector("#content .list");
      // 获取第一屏小圆点的DOM节点
      var home2LiNodes = document.querySelectorAll(
        "#content > .list > .home .home2 > li"
      );
      // 获取第一屏需要切换的轮播图DOM节点
      var home1LiNodes = document.querySelectorAll(
        "#content > .list > .home .home1 > li"
      );
      var home1 = document.querySelector("#content > .list > .home .home1");
      // 同步当前屏的索引
      var now = 0;
      // 定时器
      var timer = 0;

      // 05-第一屏交互效果
      var oldIndex = 0;
      var timer3D = 0;
      var autoIndex = 0;
      home3D();
      function home3D(params) {
        for (let i = 0; i < home2LiNodes.length; i++) {
          // 绑定点击事件
          home2LiNodes[i].onclick = function () {
            clearInterval(timer3D);
            console.log(timer3D);
            for (let i = 0; i < home2LiNodes.length; i++) {
              home2LiNodes[i].classList.remove("active");
            }
            this.classList.add("active");

            //从左往右 当前索引大于上一次 rightShow leftHide
            if (i > oldIndex) {
              home1LiNodes[i].classList.remove("rightHide");
              home1LiNodes[i].classList.remove("leftHide");
              home1LiNodes[i].classList.remove("leftShow");
              home1LiNodes[i].classList.add("rightShow");

              home1LiNodes[oldIndex].classList.remove("rightHide");
              home1LiNodes[oldIndex].classList.remove("rightShow");
              home1LiNodes[oldIndex].classList.remove("leftShow");
              home1LiNodes[oldIndex].classList.add("leftHide");
            }

            //从右往左 当前索引小于上一次
            if (i < oldIndex) {
              home1LiNodes[i].classList.remove("rightHide");
              home1LiNodes[i].classList.remove("leftHide");
              home1LiNodes[i].classList.remove("rightShow");
              home1LiNodes[i].classList.add("leftShow");

              home1LiNodes[oldIndex].classList.remove("leftHide");
              home1LiNodes[oldIndex].classList.remove("rightShow");
              home1LiNodes[oldIndex].classList.remove("leftShow");
              home1LiNodes[oldIndex].classList.add("rightHide");
            }

            oldIndex = i;
            autoIndex = i;

            // 重新开启定时器
            move();
          };
        }
        move();
        // 从左向右自动轮播
        function move() {
          clearInterval(timer)
          timer3D = setInterval(() => {
            autoIndex++;
            if(autoIndex === home1LiNodes.length){
              autoIndex = 0;
            }
            home1LiNodes[autoIndex].classList.remove("rightHide");
            home1LiNodes[autoIndex].classList.remove("leftHide");
            home1LiNodes[autoIndex].classList.remove("leftShow");
            home1LiNodes[autoIndex].classList.add("rightShow");
            home2LiNodes[autoIndex].classList.add("active");

            home1LiNodes[oldIndex].classList.remove("rightHide");
            home1LiNodes[oldIndex].classList.remove("rightShow");
            home1LiNodes[oldIndex].classList.remove("leftShow");
            home1LiNodes[oldIndex].classList.add("leftHide");
            home2LiNodes[oldIndex].classList.remove("active");

            oldIndex = autoIndex;
          }, 3000);
        }
        // 移入停止滚动
        home1.onmouseenter = function(){
          clearInterval(timer3D)
        }
        // 移出继续滚动
        home1.onmouseleave = function(){
          move();
        }
      }

      // 04-内容区交互——滚轮
      if (content.addEventListener) {
        content.addEventListener("DOMMouseScroll", (ev) => {
          ev = ev || event;
          clearTimeout(timer);
          timer = setTimeout(() => {
            fn(ev);
          }, 200);
        });
      }
      content.onmousewheel = function (ev) {
        ev = ev || event;
        clearTimeout(timer);
        timer = setTimeout(() => {
          fn(ev);
        }, 200);
      };
      function fn(ev) {
        // ev = ev || event;
        var dir = "";
        if (ev.wheelDelta) {
          dir = ev.wheelDelta > 0 ? "up" : "down";
        } else if (ev.detail) {
          dir = ev.wheelDelta < 0 ? "up" : "down";
        }
        switch (dir) {
          case "up":
            if (now > 0) {
              now--;
            }
            move(now);
            break;
          case "down":
            if (now < cLiNodes.length - 1) {
              now++;
              move(now);
            }

            break;
        }
      }

      // 03-调整分辨率时的适配
      window.onresize = function () {
        contentBind();
        cList.style.top =
          -now * (document.documentElement.clientHeight - head.offsetHeight) +
          "px";
        arrow.style.left =
          liNodes[now].offsetLeft +
          liNodes[now].offsetWidth / 2 -
          arrow.offsetWidth / 2 +
          "px";
      };

      contentBind();
      // 02-绑定内容区交互事件
      function contentBind() {
        content.style.height =
          document.documentElement.clientHeight - head.offsetHeight + "px";
        for (let i = 0; i < cLiNodes.length; i++) {
          cLiNodes[i].style.height =
            document.documentElement.clientHeight - head.offsetHeight + "px";
        }
      }

      headBind();
      // 默认屏
      move(0);
      // 01-绑定头部交互事件
      function headBind() {
        // 首屏打开时箭头移动到home标签下
        firstUpNode.style.width = "100%";
        arrow.style.left =
          firstLiNode.offsetLeft +
          firstLiNode.offsetWidth / 2 -
          arrow.offsetWidth / 2 +
          "px";
        // 设置点击标签时箭头的移动和标签样式的改变
        for (let i = 0; i < liNodes.length; i++) {
          liNodes[i].onclick = function () {
            move(i);
            now = i;
          };
        }
      }
      // 小箭头移动和图标样式变换函数
      function move(i) {
        for (let j = 0; j < upNodes.length; j++) {
          upNodes[j].style.width = "";
        }
        upNodes[i].style.width = "100%";
        arrow.style.left =
          liNodes[i].offsetLeft +
          liNodes[i].offsetWidth / 2 -
          arrow.offsetWidth / 2 +
          "px";
        cList.style.top =
          -i * (document.documentElement.clientHeight - head.offsetHeight) +
          "px";
        // console.log(cList.style.top);
      }
    };
  </script>
</html>
